# 概要 
vim に関する置換操作について纏めます。

# 詳細 

### タブをスペースに変換する
タブをスペース何文字と設定するかの設定を行います。最後にretabします。
```
:set tabstop=4
:set expandtab
:retab
```

- 参考
  - http://d.hatena.ne.jp/stylist/20120422/1335094553

### スペースをタブに変換する
スペース何文字がタブに相当するかを指定します。
```
:set shiftwidth=4
:set noetlretab!
```

- 参考
  - http://d.hatena.ne.jp/stylist/20120422/1335094553

### 指定した行だけ置換したい 
例えば、130行目、150行目の「test」という文字列を「beta」に置換する場合、以下の指定を行います。
```
:130,150s/test/beta/gc
※その行に存在する全ての指定した文字列を置換する場合:  gを付加する
  対話的に置換作業を進める場合:                        cを付加する
```

### 置換時に改行を挿入したい 
vimで%sを利用して改行を挿入したい場合には以下の用にしたいと思うかもしれません
```
:%s/<文字列A>/<文字列A>\n/g
```
しかし、上記コマンド実行をしても改行としてではなく、特殊文字として置換されてしまいます。  
vimで改行を挿入する場合には、"\n"の部分を改行コードとしてvimに認識させる必要があります。この改行コードは以下の様にして挿入します。  
改行コードを挿入する為にはCtrl+vと押した後にEnterを押す。


### ある文字を含む行を削除したい。 
```
:g/<文字列>/d
```

とすればよい。 例えば、空行を含む行を全て削除する場合には以下の様にする。
```
:g/^$/d
```

### ある文字を含まない行を削除したい。 
```
:v/<文字列>/d
```
とすればよい。

### ある文字を含む行で、文字列Aを文字列Bに変更したい。 
```
:g/<ある文字>/s/<文字列A>/<文字列B>
```

例えば、httpsという文字を含む行でmobileという文字をphoneと変更したい 場合には以下の様にすればよい。
```
:g/https/s/mobile/phone
```

### ある文字を含まない行で、文字列Aを文字列Bに置換したい。 
これは上記項目と反対である文字を含まない行である。
```
:v/<ある文字>/s/<文字列A>/<文字列B>
```

### 行番号を行頭に付加したい。 
以下の様にしてできます。実際に試してみるのが一番理解が早いです。
```
:%s/^/\=line('.').' '/ 
```

### 末尾が^Mとなっている場合の対処法 
```
:e ++ff=mac
```
