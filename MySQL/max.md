# 概要
最大値の取得に関するメモです。

# 詳細
### 最大値のレコードに紐づく値を取得する。
次のようにして取得できそうに見えますが、これでは取得できません。
```
mysql> SELECT MAX(city_id), country_id FROM city;
+--------------+------------+
| MAX(city_id) | country_id |
+--------------+------------+
|          600 |          1 |
+--------------+------------+
1 row in set (0.00 sec)
```

しかし、テーブルを確認すると上記はcity_id=600のレコードのcountry_idになるわけではありません。
```
mysql> SELECT * FROM city WHERE city_id=600;
+---------+------------+------------+---------------------+
| city_id | city       | country_id | last_update         |
+---------+------------+------------+---------------------+
|     600 | Ziguinchor |         83 | 2006-02-15 04:45:25 |
+---------+------------+------------+---------------------+
1 row in set (0.00 sec)
```

ではGROUP BYするとどうなるでしょうか。
これは同一テーブル上にcity_idが重複できるようなレコードで、その中での最大のcontry_idを取得したい場合に利用できます。
```
mysql> SELECT MAX(city_id), country_id FROM city GROUP BY city_id;
+--------------+------------+
| MAX(city_id) | country_id |
+--------------+------------+
|            1 |         87 |
|            2 |         82 |
|            3 |        101 |

...

|          596 |         69 |
|          597 |         80 |
|          598 |         51 |
|          599 |         23 |
|          600 |         83 |
+--------------+------------+
600 rows in set (0.00 sec)
```

最大となるcity_id=600の場合のcountry_idが欲しいのですが、この場合は上記のSQLを昇順でソートして1件だけ取得でも可能ですが、次のように
最大値を取得して求めることもできます。
```
mysql> SELECT city_id, country_id FROM city WHERE city_id = (SELECT MAX(city_id) FROM city);
+---------+------------+
| city_id | country_id |
+---------+------------+
|     600 |         83 |
+---------+------------+
1 row in set (0.00 sec)
```
